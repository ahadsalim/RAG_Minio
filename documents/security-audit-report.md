# ฺฏุฒุงุฑุด ุจุฑุฑุณ ุงููุช ุณุฑูุฑ MinIO Production
**ุชุงุฑุฎ:** 2026-02-17  
**ุณุฑูุฑ:** minio (192.168.100.105 / 10.10.10.50)  
**ูุถุนุช:** โ ุชูุงู ูุดฺฉูุงุช ุงููุช ุจุฑุทุฑู ุดุฏ

---

## ุฎูุงุตู ุงุฌุฑุง
ุจุฑุฑุณ ุงููุช ฺฉุงูู ุฑู ุณุฑูุฑ MinIO ุงูุฌุงู ุดุฏ. **4 ูุดฺฉู ุงููุช ุจุญุฑุงู** ุดูุงุณุง ู ุจุฑุทุฑู ฺฏุฑุฏุฏ. ุณุฑูุฑ ุฏุฑ ุญุงู ุญุงุถุฑ ุฏุฑ ุจุฑุงุจุฑ ุญููุงุช ูุดุงุจู Redis ฺฉู ูุจูุงู ุชุฌุฑุจู ุดุฏู ุจูุฏุ ูุญุงูุธุช ุดุฏู ุงุณุช.

---

## ูุดฺฉูุงุช ุงููุช ุดูุงุณุง ุดุฏู

### ๐ด ูุดฺฉู ฑ: DOCKER-USER chain ุฎุงู (ุจุญุฑุงูโุชุฑู)
- **ูุถุนุช ูุจู:** Docker ุจู ุทูุฑ ฺฉุงูู UFW ุฑุง ุฏูุฑ ูโุฒุฏ
- **ุฎุทุฑ:** ุชูุงู ูพูุฑุชโูุง Docker ุงุฒ ุงูุชุฑูุช ูุงุจู ุฏุณุชุฑุณ ุจูุฏูุฏ
- **ูุถุนุช ุจุนุฏ:** โ DOCKER-USER chain ุจุง ููุงูู ุงููุช ูพฺฉุฑุจูุฏ ุดุฏ

### ๐ด ูุดฺฉู ฒ: ูพูุฑุชโูุง MinIO ุงุฒ ุงูุชุฑูุช ุจุงุฒ
- **ูุถุนุช ูุจู:** ูพูุฑุช 9000 ู 9001 ุงุฒ ุงูุชุฑูุช ูุงุจู ุฏุณุชุฑุณ
- **ุฎุทุฑ:** ุงุญุชูุงู ุญููู brute-force ุง ุงุณุชูุงุฏู ุบุฑูุฌุงุฒ ุงุฒ S3 API
- **ูุถุนุช ุจุนุฏ:** โ ูุญุฏูุฏ ุจู 127.0.0.1 ู ููุท ุงุฒ LAN/DMZ ูุงุจู ุฏุณุชุฑุณ

### ๐ก ูุดฺฉู ณ: ูพูุฑุชโูุง Monitoring ุจุงุฒ
- **ูุถุนุช ูุจู:** cAdvisor (8080) ู Node Exporter (9100) ุงุฒ ุดุจฺฉู ุจุงุฒ
- **ุฎุทุฑ:** ุงูุดุง ุงุทูุงุนุงุช ุญุณุงุณ ุณุณุชู
- **ูุถุนุช ุจุนุฏ:** โ ููุท ุงุฒ LAN/DMZ ูุงุจู ุฏุณุชุฑุณ

### ๐ก ูุดฺฉู ด: UFW ุชููุง ูุงู ุฏูุงุน
- **ูุถุนุช ูุจู:** UFW ูุนุงู ุงูุง Docker ุขู ุฑุง bypass ูโฺฉุฑุฏ
- **ูุถุนุช ุจุนุฏ:** โ UFW + DOCKER-USER chain ูุฑ ุฏู ูุนุงู

---

## ุงูุฏุงูุงุช ุงูุฌุงู ุดุฏู

### โ ูุฑุญูู ฑ: ุจุฑุฑุณ ูููุฐ ุงุญุชูุงู
- ูฺ ูพุฑูุณู crypto miner ุงูุช ูุดุฏ
- crontabโูุง ูุดฺฉูฺฉ ูุฌูุฏ ูุฏุงุฑุฏ
- ูุงูโูุง ูุดฺฉูฺฉ ุฏุฑ /tmp ุงูุช ูุดุฏ
- ูุงฺฏูโูุง SSH ููฺฏ ุงุฒ IPูุง ุฏุงุฎู ุดุจฺฉู
- **ูุชุฌู:** ุณุฑูุฑ ุขููุฏู ูุณุช โ

### โ ูุฑุญูู ฒ: ูุญุฏูุฏ ฺฉุฑุฏู ูพูุฑุชโูุง Docker
**ูุงู:** `/srv/deployment/docker-compose.yml`
```yaml
# ูุจู:
ports:
  - "9000:9000"
  - "9001:9001"

# ุจุนุฏ:
ports:
  - "127.0.0.1:9000:9000"
  - "127.0.0.1:9001:9001"
```
**Commit:** `576ef8d` - security: restrict MinIO ports to localhost only

### โ ูุฑุญูู ณ: ูพฺฉุฑุจูุฏ UFW
ููุงูู ุงุถุงูู ุดุฏู:
- ุญุฐู ุฏุณุชุฑุณ ุนููู ุจู ูพูุฑุช 9000/9001
- ุงุถุงูู ฺฉุฑุฏู ุฏุณุชุฑุณ ุงุฒ LAN (192.168.100.0/24)
- ุงุถุงูู ฺฉุฑุฏู ุฏุณุชุฑุณ ุงุฒ DMZ (10.10.10.0/24)
- ูุญุฏูุฏ ฺฉุฑุฏู ูพูุฑุชโูุง Monitoring (8080, 9100)

### โ ูุฑุญูู ด: ุชูุธู DOCKER-USER iptables chain
**ูุงู:** `/etc/ufw/after.rules`
- ููุงูู DOCKER-USER ุงุถุงูู ุดุฏ
- ููุท ูพูุฑุช 22, 80, 443 ุงุฒ ุงูุชุฑูุช ูุฌุงุฒ
- LAN/DMZ ุจู ุชูุงู ุณุฑูุณโูุง ุฏุณุชุฑุณ ุฏุงุฑูุฏ
- ุจูู ุชุฑุงูฺฉ DROP ูโุดูุฏ

**Systemd Service:** `/etc/systemd/system/docker-user-iptables.service`
- ููุงูู ุจุนุฏ ุงุฒ restart Docker ุญูุธ ูโุดููุฏ
- Auto-start ุฏุฑ boot ูุนุงู ุงุณุช

---

## ูุถุนุช ููุง

### ูพูุฑุชโูุง ุจุงุฒ ุงุฒ ุงูุชุฑูุช (0.0.0.0):
```
22/tcp   - SSH (OpenSSH)
```

### ูพูุฑุชโูุง localhost (127.0.0.1):
```
9000/tcp - MinIO S3 API
9001/tcp - MinIO Console
```

### ูพูุฑุชโูุง ุดุจฺฉู (host mode):
```
8080/tcp - cAdvisor (ููุท LAN/DMZ)
9100/tcp - Node Exporter (ููุท LAN/DMZ)
```

### DOCKER-USER Chain:
```
โ ESTABLISHED/RELATED connections
โ Docker networks (172.16.0.0/12)
โ LAN subnet (192.168.100.0/24)
โ DMZ subnet (10.10.10.0/24)
โ Localhost (127.0.0.0/8)
โ Port 22, 80, 443 from anywhere
โ DROP all other traffic
```

### UFW Status:
```
โ Active and enabled on system startup
โ Default: deny incoming, allow outgoing
โ 10 rules configured
```

---

## ุชุณุชโูุง ุงูุฌุงู ุดุฏู

1. โ ฺฉุงูุชูุฑูุง ุจุง ููููุช restart ุดุฏูุฏ
2. โ MinIO ุงุฒ localhost ูุงุจู ุฏุณุชุฑุณ ุงุณุช (HTTP 403)
3. โ MinIO ุงุฒ IP ุนููู ูุงุจู ุฏุณุชุฑุณ ูุณุช (timeout)
4. โ DOCKER-USER chain ูุนุงู ุงุณุช (9 rules)
5. โ UFW ูุนุงู ุงุณุช (10 rules)
6. โ SSH ููฺูุงู ฺฉุงุฑ ูโฺฉูุฏ
7. โ systemd service ูุนุงู ู enabled ุงุณุช

---

## ุชูุตูโูุง ุงููุช ุงุถุงู

### ุจุฑุง ุขูุฏู:
1. **Fail2ban:** ูุตุจ Fail2ban ุจุฑุง ูุญุงูุธุช ุงุฒ SSH ุฏุฑ ุจุฑุงุจุฑ brute-force
2. **SSL/TLS:** ุงุถุงูู ฺฉุฑุฏู SSL ุจุฑุง MinIO (ุฏุฑ ุตูุฑุช ูุงุฒ ุจู ุฏุณุชุฑุณ ุงุฒ DMZ)
3. **Monitoring:** ุฑุงูโุงูุฏุงุฒ alerting ุจุฑุง ุชูุงุดโูุง ุฏุณุชุฑุณ ุบุฑูุฌุงุฒ
4. **Backup Testing:** ุชุณุช ููุธู backup ู restore
5. **Update Policy:** ุจูโุฑูุฒุฑุณุงู ููุธู Docker images

### ูฺฉุงุช ููู:
- โ๏ธ ูุฑฺฏุฒ ูพูุฑุชโูุง ุฏุงุฎู ุฑุง ุจุฏูู `127.0.0.1` ุฏุฑ docker-compose ุจุงุฒ ูฺฉูุฏ
- โ๏ธ ููุดู DOCKER-USER chain ุฑุง ูพฺฉุฑุจูุฏ ฺฉูุฏ (UFW ุจู ุชููุง ฺฉุงู ูุณุช)
- โ๏ธ ูุจู ุงุฒ ูุฑ ุชุบุฑ ุฏุฑ ูุงุฑูุงูุ ูุทูุฆู ุดูุฏ SSH ุจุงุฒ ุงุณุช
- โ๏ธ ุจุนุฏ ุงุฒ restart Dockerุ ููุงูู DOCKER-USER ุฑุง ุจุฑุฑุณ ฺฉูุฏ

---

## ูุงูโูุง ุชุบุฑ ุงูุชู

1. `/srv/deployment/docker-compose.yml` - ูพูุฑุชโูุง MinIO ูุญุฏูุฏ ุดุฏ
2. `/etc/ufw/after.rules` - ููุงูู DOCKER-USER ุงุถุงูู ุดุฏ
3. `/etc/systemd/system/docker-user-iptables.service` - ุณุฑูุณ ุฌุฏุฏ
4. `/etc/ufw/after.rules.backup` - ูุณุฎู ูพุดุชุจุงู

---

## ูุชุฌูโฺฏุฑ

โ **ุณุฑูุฑ ุฏุฑ ุญุงู ุญุงุถุฑ ุงูู ุงุณุช ู ุฏุฑ ุจุฑุงุจุฑ ุญููุงุช ูุดุงุจู Redis ูุญุงูุธุช ุดุฏู ุงุณุช.**

ุชูุงู ูพูุฑุชโูุง ุญุณุงุณ (MinIO, Monitoring) ููุท ุงุฒ ุดุจฺฉูโูุง ุฏุงุฎู ูุงุจู ุฏุณุชุฑุณ ูุณุชูุฏ. Docker ุฏฺฏุฑ ููโุชูุงูุฏ ูุงุฑูุงู ุฑุง ุฏูุฑ ุจุฒูุฏ. ููุงูู ุงููุช ูพุงุฏุงุฑ ูุณุชูุฏ ู ุจุนุฏ ุงุฒ restart ุญูุธ ูโุดููุฏ.

---

**ุชููโฺฉููุฏู:** Cascade AI Security Audit  
**ุชุงุฑุฎ:** 2026-02-17 14:46 UTC
